testsDeclensionEn = 
{"activity":{"N":{"p":"activities"}},
 "all":{"Adv":{"co":"all"}},
 "analysis":{"N":{"p":"analyses"}},
 "audience":{"N":{"p":"audiences"}},
 "avocado":{"N":{"p":"avocados"}},
 "bad":{"A":{"co":"worse",
             "su":"worst"}},
 "badly":{"Adv":{"co":"more badly"}},
 "basis":{"N":{"p":"bases"}},
 "batch":{"N":{"p":"batches"}},
 "berry":{"N":{"p":"berries"}},
 "big":{"A":{"co":"bigger",
             "su":"biggest"}},
 "box":{"N":{"p":"boxes"}},
 "boy":{"N":{"p":"boys"}},
 "bunch":{"N":{"p":"bunches"}},
 "bus":{"N":{"p":"buses"}},
 "businessman":{"N":{"p":"businessmen"}},
 "calf":{"N":{"p":"calves"}},
 "car":{"N":{"p":"cars"}},
 "cargo":{"N":{"p":"cargoes"}},
 "cattle":{"N":{"p":"cattle"}},
 "chairman":{"N":{"p":"chairmen"}},
 "chief":{"N":{"p":"chiefs"}},
 "child":{"N":{"p":"children"}},
 "choir":{"N":{"p":"choirs"}},
 "church":{"N":{"p":"churches"}},
 "city":{"N":{"p":"cities"}},
 "civil":{"A":{"co":"civiller",
               "su":"civillest"}},
 "clergy":{"N":{"p":"clergies"}},
 "clothes":{"N":{"p":"clothes"}},
 "coalition":{"N":{"p":"coalitions"}},
 "collection":{"N":{"p":"collections"}},
 "committee":{"N":{"p":"committees"}},
 "commons":{"N":{"p":"commons"}},
 "constituency":{"N":{"p":"constituencies"}},
 "corps":{"N":{"p":"corps"}},
 "council":{"N":{"p":"councils"}},
 "craftsman":{"N":{"p":"craftsmen"}},
 "crew":{"N":{"p":"crews"}},
 "crisis":{"N":{"p":"crises"}},
 "day":{"N":{"p":"days"}},
 "diagnosis":{"N":{"p":"diagnoses"}},
 "elite":{"N":{"p":"elites"}},
 "emphasis":{"N":{"p":"emphases"}},
 "establishment":{"N":{"p":"establishments"}},
 "far":{"A":{"co":"farther",
             "su":"farthest"}},
 "fat":{"A":{"co":"fatter",
             "su":"fattest"}},
 "fisherman":{"N":{"p":"fishermen"}},
 "fit":{"A":{"co":"fitter",
             "su":"fittest"}},
 "flat":{"A":{"co":"flatter",
              "su":"flattest"}},
 "fleet":{"N":{"p":"fleets"}},
 "foot":{"N":{"p":"feet"}},
 "formula":{"N":{"p":"formulas"}},
 "gang":{"N":{"p":"gangs"}},
 "gentleman":{"N":{"p":"gentlemen"}},
 "glad":{"A":{"co":"gladder",
              "su":"gladdest"}},
 "go":{"N":{"p":"goes"}},
 "good":{"A":{"co":"better",
              "su":"best"}},
 "government":{"N":{"p":"governments"}},
 "grim":{"A":{"co":"grimmer",
              "su":"grimmest"}},
 "half":{"N":{"p":"halves"}},
 "handful":{"N":{"p":"handfuls"}},
 "headquarters":{"N":{"p":"headquarters"}},
 "herd":{"N":{"p":"herds"}},
 "hero":{"N":{"p":"heroes"}},
 "hot":{"A":{"co":"hotter",
             "su":"hottest"}},
 "household":{"N":{"p":"households"}},
 "housewife":{"N":{"p":"housewives"}},
 "hypothesis":{"N":{"p":"hypotheses"}},
 "jeans":{"N":{"p":"jeans"}},
 "knife":{"N":{"p":"knives"}},
 "lab":{"N":{"p":"labs"}},
 "life":{"N":{"p":"lives"}},
 "little":{"Adv":{"co":"less"}},
 "loyal":{"A":{"co":"loyaller",
               "su":"loyallest"}},
 "mad":{"A":{"co":"madder",
             "su":"maddest"}},
 "man":{"N":{"p":"men"}},
 "management":{"N":{"p":"managements"}},
 "monarch":{"N":{"p":"monarchs"}},
 "mouse":{"N":{"p":"mice"}},
 "navy":{"N":{"p":"navies"}},
 "neighbourhood":{"N":{"p":"neighbourhoods"}},
 "number":{"N":{"p":"numbers"}},
 "orchestra":{"N":{"p":"orchestras"}},
 "pair":{"N":{"p":"pairs"}},
 "person":{"N":{"p":"people"}},
 "personnel":{"N":{"p":"personnels"}},
 "police":{"N":{"p":"police"}},
 "policeman":{"N":{"p":"policemen"}},
 "potato":{"N":{"p":"potatoes"}},
 "quantum":{"N":{"p":"quanta"}},
 "red":{"A":{"co":"redder",
             "su":"reddest"}},
 "regiment":{"N":{"p":"regiments"}},
 "roof":{"N":{"p":"roofs"}},
 "sad":{"A":{"co":"sadder",
             "su":"saddest"}},
 "self":{"N":{"p":"selves"}},
 "senate":{"N":{"p":"senates"}},
 "series":{"N":{"p":"series"}},
 "sheep":{"N":{"p":"sheep"}},
 "shelf":{"N":{"p":"shelves"}},
 "shy":{"A":{"co":"shyer",
             "su":"shyest"}},
 "slim":{"A":{"co":"slimmer",
              "su":"slimmest"}},
 "solo":{"N":{"p":"solos"}},
 "species":{"N":{"p":"species"}},
 "spokesman":{"N":{"p":"spokesmen"}},
 "stimulus":{"N":{"p":"stimuli"}},
 "stomach":{"N":{"p":"stomachs"}},
 "synthesis":{"N":{"p":"syntheses"}},
 "team":{"N":{"p":"teams"}},
 "thesis":{"N":{"p":"theses"}},
 "thief":{"N":{"p":"thieves"}},
 "thin":{"A":{"co":"thinner",
              "su":"thinnest"}},
 "tomato":{"N":{"p":"tomatoes"}},
 "tooth":{"N":{"p":"teeth"}},
 "well":{"A":{"co":"better",
              "su":"best"}},
 "wet":{"A":{"co":"wetter",
             "su":"wettest"}},
 "wife":{"N":{"p":"wives"}},
 "wolf":{"N":{"p":"wolves"}},
 "woman":{"N":{"p":"women"}},
 "wrong":{"A":{"co":"wronger",
               "su":"wrongest"}},
 "zero":{"N":{"p":"zeros"}},
 "zoo":{"N":{"p":"zoos"}}
};

testPronounDeclensionEn=[
    ["I",{"I":{"n":"s","ow":"s","g":"m","pe":1}}],
    ["me",{"me":{"n":"s","ow":"s","g":"m","pe":1}}],
    ["mine",{"mine":{"n":"s","ow":"s","g":"m","pe":1}}],
    ["myself",{"myself":{"n":"s","ow":"s","g":"m","pe":1}}],
    ["I",{"you":{"n":"s","ow":"s","g":"m","pe":2}}],
    ["me",{"you":{"n":"s","ow":"s","g":"m","pe":2}}],
    ["mine",{"yours":{"n":"s","ow":"s","g":"m","pe":2}}],
    ["myself",{"yourself":{"n":"s","ow":"s","g":"m","pe":2}}],
    ["I",{"he":{"n":"s","ow":"s","g":"m","pe":3}}],
    ["me",{"him":{"n":"s","ow":"s","g":"m","pe":3}}],
    ["mine",{"his":{"n":"s","ow":"s","g":"m","pe":3}}],
    ["myself",{"himself":{"n":"s","ow":"s","g":"m","pe":3}}],
    ["I",{"she":{"n":"s","ow":"s","g":"f","pe":3}}],
    ["me",{"her":{"n":"s","ow":"s","g":"f","pe":3}}],
    ["mine",{"hers":{"n":"s","ow":"s","g":"f","pe":3}}],
    ["myself",{"herself":{"n":"s","ow":"s","g":"f","pe":3}}],
    ["I",{"it":{"n":"s","ow":"s","g":"n","pe":3}}],
    ["me",{"it":{"n":"s","ow":"s","g":"n","pe":3}}],
    ["mine",{"its":{"n":"s","ow":"s","g":"n","pe":3}}],
    ["myself",{"itself":{"n":"s","ow":"s","g":"n","pe":3}}],
    ["I",{"we":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["me",{"us":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["mine",{"ours":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["myself",{"ourselves":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["I",{"you":{"n":"p","ow":"p","g":"m","pe":2}}],
    ["me",{"you":{"n":"p","ow":"p","g":"m","pe":2}}],
    ["mine",{"yours":{"n":"p","ow":"p","g":"m","pe":2}}],
    ["myself",{"yourselves":{"n":"p","ow":"p","g":"m","pe":2}}],
    ["I",{"they":{"n":"p","ow":"p","g":"m","pe":3}}],
    ["me",{"them":{"n":"p","ow":"p","g":"m","pe":3}}],
    ["mine",{"theirs":{"n":"p","ow":"p","g":"m","pe":3}}],
    ["myself",{"themselves":{"n":"p","ow":"p","g":"m","pe":3}}],
    ["why",{"why":{"n":"p","g":"m","pe":1}}],
    ["who",{"who":{"n":"p","g":"m","pe":1}}],
    ["where",{"where":{"n":"p","g":"m","pe":1}}],
    ["this",{"these":{"n":"p","g":"m","pe":3}}],
    ["that",{"those":{"n":"p","g":"m","pe":3}}],
]

testDetDeclensionEn=[
    ["a",{"":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["my",{"our":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["that",{"those":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["what",{"what":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["which",{"which":{"n":"p","ow":"p","g":"m","pe":1}}],
    ["whose",{"whose":{"n":"p","ow":"p","g":"m","pe":1}}],
]

QUnit.test( "English declension", function( assert ) {
    Object.assign(globalThis,jsRealB);
    loadEn();
    var exp=N("love").n("p")
    assert.equal(exp.realize(), "loves", exp.toSource());
    
    for (let [word,wordInfo] of Object.entries(testsDeclensionEn)){
        for (let [pos,expected] of Object.entries(wordInfo)){
            if (pos=="N"){
                exp=N(word).n("p")
                assert.equal(exp.realize(),expected["p"],exp.toSource()+"=>"+expected["p"])
            } else if (pos=="A"){
                exp=A(word).f("co")
                assert.equal(exp.realize(),expected["co"],exp.toSource()+"=>"+expected["co"])
                exp=A(word).f("su")
                assert.equal(exp.realize(),expected["su"],exp.toSource()+"=>"+expected["su"])
            } else if (pos=="Adv"){
                exp=Adv(word).f("co")
                assert.equal(exp.realize(),expected["co"],exp.toSource()+"=>"+expected["co"])
            }
        }
    }
    
    for (var i = 0; i < testPronounDeclensionEn.length; i++) {
        var pro=testPronounDeclensionEn[i][0];
        var proInfo=testPronounDeclensionEn[i][1];
        for (let [expected,proFlags] of Object.entries(proInfo)){
            exp=Pro(pro).n(proFlags["n"]).g(proFlags["g"]).pe(proFlags["pe"])
            if (proFlags["ow"]!==undefined)exp=exp.ow(proFlags["ow"]);
            
            assert.equal(exp.realize(),expected,exp.toSource()+"=>"+expected)
        }
    }
    
    for (var i = 0; i < testDetDeclensionEn.length; i++) {
        var pro=testDetDeclensionEn[i][0];
        var proInfo=testDetDeclensionEn[i][1];
        for (let [expected,proFlags] of Object.entries(proInfo)){
            exp=D(pro).n(proFlags["n"]).g(proFlags["g"]).pe(proFlags["pe"])
            if (proFlags["ow"]!==undefined)exp=exp.ow(proFlags["ow"]);
            assert.equal(exp.realize(),expected,exp.toSource()+"=>"+expected)
        }
    }
});
